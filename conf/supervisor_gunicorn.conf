; Supervisor 配置文件 - Wizard 项目（使用 Gunicorn）
; 注意：这是使用 Gunicorn 作为 WSGI 服务器的配置
; 如果使用 Flask 内置服务器，请使用 supervisor_wizard.conf

[program:wizard]
; 程序名称
command=/path/to/wizard/.venv/bin/gunicorn -w 4 -b 0.0.0.0:5005 --timeout 120 --access-logfile /var/log/wizard/access.log --error-logfile /var/log/wizard/error.log run:my_app

; 工作目录
directory=/path/to/wizard

; 启动用户
; user=www-data

; ========== 自动管理配置 ==========
autostart=true
autorestart=true
startretries=3
startsecs=5

; ========== 停止配置 ==========
stopsignal=TERM
stopwaitsecs=10
stopasgroup=true
killasgroup=true

; ========== 日志配置 ==========
; Gunicorn 的日志已经在 command 中配置，这里只配置 supervisor 的日志
stdout_logfile=/var/log/wizard/supervisor_stdout.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10

stderr_logfile=/var/log/wizard/supervisor_stderr.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10

; ========== 环境变量 ==========
environment=PYTHONUNBUFFERED="1",PYTHONPATH="/path/to/wizard",FLASK_ENV="production"

; ========== 进程配置 ==========
numprocs=1
priority=999
exitcodes=0,2
